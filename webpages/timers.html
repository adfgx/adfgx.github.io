<!DOCTYPE html>
<html>
<head>
  <title>Interval Timers</title>
  <style>
    body {
      background-color: rgb(235, 116, 116);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      overflow-y: auto; /* Enable vertical scrolling for the page */
    }
    #button-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      width: 100%;
      padding: 10px;
    }
    .Rtimer1, .Rtimer2, .Rtimer3, .Rtimer4, .Rtimer5, .Itimer1, .Itimer2, .Itimer3, .Itimer4, 
    .Ctimer1, .Ctimer2, .Ctimer3, .Ctimer4, .Ctimer5, .Ctimer6, .Ctimer7, .Retimer1, .Retimer2, .Retimer3 {
      font-size: 3vw;
      padding: 10px;
      margin: 5px;
      cursor: pointer;
      background-color: #00c3ff;
      color: white;
      border: none;
      border-radius: 5px;
      display: none;
    }
    .button1, .button2, .button3, .button4 {
      font-size: 3vw;
      padding: 10px;
      margin: 5px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
    }
    #display-area {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      margin-top: 20px;
    }
    #display {
      font-size: 6vw;
      color: black;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      margin-top: 20px;
    }
    #flexdance {
      height: 15vh;
      width: 25vh;
      margin-top: 5px;
    }
    /* Container for information text */
    .info-container {
      width: 90%;
      max-width: 800px;
      margin-top: 20px;
      padding: 15px;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 5px;
    }
    /* Style for button information text */
    .button-info {
      font-size: 1.2vw;
      color: white;
      margin-top: 10px;
    }
    /* Container for buttons at the bottom */
    #button-link-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      width: 100%;
      padding: 10px;
    }
    /* Style for buttons at the bottom */
    #index, #command-timer, #map, #interval-timer {
      font-size: 3vw;
      padding: 10px;
      margin: 5px;
      cursor: pointer;
      color: white;
      background-color: #a31b81;
      border: none;
      border-radius: 5px;
      text-decoration: none;
    }
    #work-cycle-list {
      font-size: 3vw;
      color: black;
      text-align: center;
      margin-left: 50px;
    }
  </style>
</head>
<body>

  <!--BUTTON CONTAINER-->
  <div id="button-container">

    <!--Roll timers-->
    <button class="Rtimer1" data-timer="16">3 min duo</button>
    <button class="Rtimer2" data-timer="17">5 min duo</button>
    <button class="Rtimer3" data-timer="18">3 min trio</button>
    <button class="Rtimer4" data-timer="19">5 min trio</button>
    <button class="Rtimer5" data-timer="20">/</button>

    <!--Interval timers-->
    <button class="Itimer1" data-timer="12">60s interval</button>
    <button class="Itimer2" data-timer="13">30sw, 10sr, 4s</button>
    <button class="Itimer3" data-timer="14">Endurance Board</button>
    <button class="Itimer4" data-timer="15">/</button>

    <!--Command timers-->
    <button class="Ctimer1" data-timer="5">B Strikes</button>
    <button class="Ctimer2" data-timer="6">B Strikes & B Takedowns</button>
    <button class="Ctimer3" data-timer="7">B Strikes & B Takedowns</button>
    <button class="Ctimer4" data-timer="8">1000ms</button>
    <button class="Ctimer5" data-timer="9">1500ms</button>
    <button class="Ctimer6" data-timer="10">2000ms</button>
    <button class="Ctimer7" data-timer="11">/</button>

    <!--Rest timers-->
    <button class="Retimer1" data-timer="21">150s</button>
    <button class="Retimer2" data-timer="22">90s</button>
    <button class="Retimer3" data-timer="23">/</button>

    <!--Dropdown buttons-->
    <button class="button1" data-timer="1">Interval</button>
    <button class="button2" data-timer="2">Command</button>
    <button class="button3" data-timer="3">Roll</button>
    <button class="button4" data-timer="4">Rest</button>

  </div>

  <!--Animated image-->
  <img id="flexdance" src="../videos/dance-lisa-simpson.gif">

  <!-- Display and Work Cycle Area -->
   <div id="display-area">
    <div id="display">Display Area</div>
    <div id="work-cycle-list"></div>
  </div>


  <!-- Information Text Container with Sample Text -->
  <div class="info-container">
    <div class="button-info">
      
    </div>
    <div class="button-info">
      Duo timers; two sets, rest is half of working set.
    </div>
    <div class="button-info">
      Trio timers; every participant rolls every combination with a minute rest. Each participant is associated with a letter; "A", "C", "T" 
    </div>
  </div>
  <!-- Button container at the bottom -->
  <div id="button-link-container">
    <a id="index" href="../index.html">back to the lobby</a>
    <a id="map" href="../webpages/map.html">map</a>
    <a id="command-timer" href="../webpages/interactive.html">command timers</a>
    <a id="interval-timer" href="../webpages/interval timers.html">interval timers</a>

  </div>

  <!-- AUDIO ELEMENTS IDENTIFICATION -->
  <audio id="audio-3" src="../sound files/3.wav"></audio>
  <audio id="audio-2" src="../sound files/2.wav"></audio>
  <audio id="audio-1" src="../sound files/1.wav"></audio>
  <audio id="audio-rest" src="../sound files/rest.mp3"></audio>
  <audio id="audio-work" src="../sound files/work.mp3"></audio>

  <script>

    //FUNCTION ASSOCIATIONS
    const displayElement = document.getElementById('display');
    const workCycleList = document.getElementById('work-cycle-list');
    //Roll timers
    const Rtimer1 = document.querySelector('.Rtimer1');
    const Rtimer2 = document.querySelector('.Rtimer2');
    const Rtimer3 = document.querySelector('.Rtimer3');
    const Rtimer4 = document.querySelector('.Rtimer4');
    const Rtimer5 = document.querySelector('.Rtimer5');
    //Interval timers
    const Itimer1 = document.querySelector('.Itimer1');
    const Itimer2 = document.querySelector('.Itimer2');
    const Itimer3 = document.querySelector('.Itimer3');
    const Itimer4 = document.querySelector('.Itimer4');
    //Command timers
    const Ctimer1 = document.querySelector('.Ctimer1');
    const Ctimer2 = document.querySelector('.Ctimer2');
    const Ctimer3 = document.querySelector('.Ctimer3');
    const Ctimer4 = document.querySelector('.Ctimer4');
    const Ctimer5 = document.querySelector('.Ctimer5');
    const Ctimer6 = document.querySelector('.Ctimer6');
    const Ctimer7 = document.querySelector('.Ctimer7');
    //Rest timers
    const Retimer1 = document.querySelector('.Retimer1');
    const Retimer2 = document.querySelector('.Retimer2');
    const Retimer3 = document.querySelector('.Retimer3');
    //Dropdown buttons
    const button1 = document.querySelector('.button1');
    const button2 = document.querySelector('.button2');
    const button3 = document.querySelector('.button3');
    const button4 = document.querySelector('.button4');

    let countdownInterval; // Stores the interval for clearing

    // Initialize hidden state for both dropdowns
    
    let areRollTimersHidden = true;
    let areIntervalTimersHidden = true;
    let areCommandTimersHidden = true;
    let areRestTimersHidden = true;

    // Hide/Show Rest timers when "Rest" button is clicked
    button4.addEventListener('click', () => {
    clearInterval(countdownInterval); // Stop any existing countdown

    // Hide Roll, Command, Interval timers if visible
    Rtimer1.style.display = 'none';
    Rtimer2.style.display = 'none';
    Rtimer3.style.display = 'none';
    Rtimer4.style.display = 'none';
    Rtimer5.style.display = 'none';
    Ctimer1.style.display = 'none';
    Ctimer2.style.display = 'none';
    Ctimer3.style.display = 'none';
    Ctimer4.style.display = 'none';
    Ctimer5.style.display = 'none';
    Ctimer6.style.display = 'none';
    Ctimer7.style.display = 'none';
    Itimer1.style.display = 'none';
    Itimer2.style.display = 'none';
    Itimer3.style.display = 'none';
    Itimer4.style.display = 'none';

    areRollTimersHidden = true;
    areCommandTimersHidden = true;
    areIntervalTimersHidden = true;

    // Toggle Rest timers visibility
    areRestTimersHidden = !areRestTimersHidden;
    const displayStyle = areRestTimersHidden ? 'none' : 'inline-block';
    Retimer1.style.display = displayStyle;
    Retimer2.style.display = displayStyle;
    Retimer3.style.display = displayStyle;
    
    displayElement.textContent = areRestTimersHidden ? "Display Area" : "Rest Timers";
    });

    // Hide/Show Interval timers when "Interval" button is clicked
    button1.addEventListener('click', () => {
    clearInterval(countdownInterval); // Stop any existing countdown

    // Hide Roll, Command, Rest timers if visible
    Rtimer1.style.display = 'none';
    Rtimer2.style.display = 'none';
    Rtimer3.style.display = 'none';
    Rtimer4.style.display = 'none';
    Rtimer5.style.display = 'none';
    Ctimer1.style.display = 'none';
    Ctimer2.style.display = 'none';
    Ctimer3.style.display = 'none';
    Ctimer4.style.display = 'none';
    Ctimer5.style.display = 'none';
    Ctimer6.style.display = 'none';
    Ctimer7.style.display = 'none';
    Retimer1.style.display = 'none';
    Retimer2.style.display = 'none';
    Retimer3.style.display = 'none';

    areRollTimersHidden = true;
    areCommandTimersHidden = true;
    areRestTimersHidden = true;

    // Toggle Interval timers visibility
    areIntervalTimersHidden = !areIntervalTimersHidden;
    const displayStyle = areIntervalTimersHidden ? 'none' : 'inline-block';
    Itimer1.style.display = displayStyle;
    Itimer2.style.display = displayStyle;
    Itimer3.style.display = displayStyle;
    Itimer4.style.display = displayStyle;
    
    displayElement.textContent = areIntervalTimersHidden ? "Display Area" : "Interval Timers";
    });

    // Hide/Show Roll timers when "Roll" button is clicked
    button3.addEventListener('click', () => {
    clearInterval(countdownInterval); // Stop any existing countdown

    // Hide Interval, Command, Rest timers if visible
    Itimer1.style.display = 'none';
    Itimer2.style.display = 'none';
    Itimer3.style.display = 'none';
    Itimer4.style.display = 'none';
    Ctimer1.style.display = 'none';
    Ctimer2.style.display = 'none';
    Ctimer3.style.display = 'none';
    Ctimer4.style.display = 'none';
    Ctimer5.style.display = 'none';
    Ctimer6.style.display = 'none';
    Ctimer7.style.display = 'none';
    Retimer1.style.display = 'none';
    Retimer2.style.display = 'none';
    Retimer3.style.display = 'none';

    areIntervalTimersHidden = true;
    areCommandTimersHidden = true;
    areRestTimersHidden = true;

    // Toggle Roll timers visibility
    areRollTimersHidden = !areRollTimersHidden;
    const displayStyle = areRollTimersHidden ? 'none' : 'inline-block';
    Rtimer1.style.display = displayStyle;
    Rtimer2.style.display = displayStyle;
    Rtimer3.style.display = displayStyle;
    Rtimer4.style.display = displayStyle;
    Rtimer5.style.display = displayStyle;

    displayElement.textContent = areRollTimersHidden ? "Display Area" : "Roll Timers";
    });

    // Hide/Show Command timers when "Command" button is clicked
    button2.addEventListener('click', () => {
    clearInterval(countdownInterval); // Stop any existing countdown

    // Hide Roll, Interval, Rest timers if visible
    Rtimer1.style.display = 'none';
    Rtimer2.style.display = 'none';
    Rtimer3.style.display = 'none';
    Rtimer4.style.display = 'none';
    Rtimer5.style.display = 'none';
    Itimer1.style.display = 'none';
    Itimer2.style.display = 'none';
    Itimer3.style.display = 'none';
    Itimer4.style.display = 'none';
    Retimer1.style.display = 'none';
    Retimer2.style.display = 'none';
    Retimer3.style.display = 'none';

    areRollTimersHidden = true;
    areIntervalTimersHidden = true;
    areRestTimersHidden = true;

    // Toggle Command timers visibility
    areCommandTimersHidden = !areCommandTimersHidden;
    const displayStyle = areCommandTimersHidden ? 'none' : 'inline-block';
    Ctimer1.style.display = displayStyle;
    Ctimer2.style.display = displayStyle;
    Ctimer3.style.display = displayStyle;
    Ctimer4.style.display = displayStyle;
    Ctimer5.style.display = displayStyle;
    Ctimer6.style.display = displayStyle;
    Ctimer7.style.display = displayStyle;

    displayElement.textContent = areCommandTimersHidden ? "Display Area" : "Command Timers";
  });
    

    // FUNCTION TO PLAY AUDIO BY ID
    function playAudio(id) {
      const audio = document.getElementById(id);
      if (audio) {
        audio.currentTime = 0;
        audio.play();
      }
    }
    
    // Function to shuffle an array
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // COUNTDOWN FUNCTION WITH VOICEOVER AND CUSTOM DISPLAY TEXT
    function startCountdown(duration, endSound, displayText, callback) {
      let timeLeft = duration;
      displayElement.textContent = `${displayText}: ${timeLeft} seconds`;
      
      countdownInterval = setInterval(() => {
        if (timeLeft <= 3) playAudio(`audio-${timeLeft}`); // Play voiceover for last 3 seconds
        
        timeLeft--;
        
        if (timeLeft < 0) {
          clearInterval(countdownInterval);
          playAudio(endSound); // Play "rest" or "work" sound
          callback();
        } else {
          displayElement.textContent = `${displayText}: ${timeLeft} seconds`;
        }
      }, 1000);
    }

    // INTERVAL TIMERS
    // Itimer1 
    function startItimer1Sequence() {
      let cycleCount = 0;

      function cycle() {
        if (cycleCount < 2) { // Repeat 2 times
          startCountdown(59, 'audio-rest', 'Work', () => {  // 60 seconds "Work" phase
            startCountdown(59, 'audio-work', 'Rest', () => {  // 60 seconds "Rest" phase
              cycleCount++;
              cycle(); // Start the next cycle
            });
          });
        } else {
          displayElement.textContent = "ITimer1"; //Timer end text content
        }
      }

      cycle(); // Start the first cycle
    }
    
    // Event listener Itimer1 button
    Itimer1.addEventListener('click', () => {
      clearInterval(countdownInterval); // Stop any existing countdown
      startCountdown(10, 'audio-work', 'Get Ready', startItimer1Sequence); // Initial 10-sec countdown
    });

    // Itimer2 
    function startItimer2Sequence() {
      let cycleCount = 0;

      function cycle() {
        if (cycleCount < 4) { // Repeat 4 times
          startCountdown(29, 'audio-rest', 'Work', () => {  // 30 seconds "Work" phase
            startCountdown(9, 'audio-work', 'Rest', () => {  // 10 seconds "Rest" phase
              cycleCount++;
              cycle(); // Start the next cycle
            });
          });
        } else {
          displayElement.textContent = "Itimer2"; //Timer end text content
        }
      }

      cycle(); // Start the first cycle
    }

    // Event listener Itimer2 button
    Itimer2.addEventListener('click', () => {
      clearInterval(countdownInterval); // Stop any existing countdown
      startCountdown(10, 'audio-work', 'Get Ready', startItimer2Sequence); // Initial 10-sec countdown
    });

    // Itimer3
    function startItimer3Sequence() {
      let cycleCount = 0;

      function cycle() {
        if (cycleCount < 8) { // Repeat 8 times
          startCountdown(9, 'audio-rest', 'Work', () => {  // 10 seconds "Work" phase
            startCountdown(4, 'audio-work', 'Rest', () => {  // 5 seconds "Rest" phase
              cycleCount++;
              cycle(); // Start the next cycle
            });
          });
        } else {
          displayElement.textContent = "Itimer3"; //Timer end text content
        }
      }

      cycle(); // Start the first cycle
    }
    
    // Event listener Itimer2 button
    Itimer3.addEventListener('click', () => {
      clearInterval(countdownInterval); // Stop any existing countdown
      startCountdown(10, 'audio-work', 'Get Ready', startItimer3Sequence); // Initial 10-sec countdown
    });

    // ROLL TIMERS
    // Rtimer1
    function startRtimer1Sequence() {
      let cycleCount = 0;

      function cycle() {
        if (cycleCount < 2) { // Repeat 3 times
          startCountdown(179, 'audio-rest', 'Work', () => {  // 180 seconds "Work" phase
            startCountdown(89, 'audio-work', 'Rest', () => {  // 90 seconds "Rest" phase
              cycleCount++;
              cycle(); // Start the next cycle
            });
          });
        } else {
          displayElement.textContent = "Rtimer1"; //Timer end text content
        }
      }

      cycle(); // Start the first cycle
    }

    // Event listener Rtimer1 button
    Rtimer1.addEventListener('click', () => {
      clearInterval(countdownInterval); // Stop any existing countdown
      startCountdown(10, 'audio-work', 'Get Ready', startRtimer1Sequence); // Initial 10-sec countdown
    });

    // Rtimer2
    function startRtimer2Sequence() {
      let cycleCount = 0;

      function cycle() {
        if (cycleCount < 2) { // Repeat 3 times
          startCountdown(299, 'audio-rest', 'Work', () => {  // 300 seconds "Work" phase
            startCountdown(149, 'audio-work', 'Rest', () => {  // 150 seconds "Rest" phase
              cycleCount++;
              cycle(); // Start the next cycle
            });
          });
        } else {
          displayElement.textContent = "Rtimer2"; //Timer end text content
        }
      }

      cycle(); // Start the first cycle
    }

    // Event listener Rtimer2 button
    Rtimer2.addEventListener('click', () => {
      clearInterval(countdownInterval); // Stop any existing countdown
      startCountdown(10, 'audio-work', 'Get Ready', startRtimer2Sequence); // Initial 10-sec countdown
    });

    // Rtimer3
    function startRtimer3Sequence(workNamesTrio1) {
      let cycleCount = 0;
      function cycle() {
      if (cycleCount < 6) {
      const currentWorkName = workNamesTrio1[cycleCount];

      // Start the work phase
      startCountdown(179, 'audio-rest', currentWorkName, () => {
        // Start the rest phase
        startCountdown(59, 'audio-work', 'Rest', () => {
          cycleCount++;
          cycle(); // Start the next cycle
        });
      });
    } else {
      displayElement.textContent = "Rtimer3"; //Timer end text content
    }
  }

  cycle(); // Start the first cycle
}

// Event listener Rtimer3 button
Rtimer3.addEventListener('click', () => {

  clearInterval(countdownInterval); // Stop any existing countdown

  // Generate and display the randomized work cycle session
  const workNamesTrio1 = ["A-T", "T-C", "C-A", "A-C", "T-A", "C-T"];
  shuffleArray(workNamesTrio1);// Shuffle once and pass it along
  workCycleList.innerHTML = `<strong>G-A:</strong><br>${workNamesTrio1.join('<br>')}`;

  //Start the "Get Ready" countdown
  startCountdown(15, 'audio-work', 'Get Ready', () => startRtimer3Sequence(workNamesTrio1)); // Initial 10-sec countdown
  });

  // Rtimer4
    function startRtimer4Sequence(workNamesTrio2) {
  let cycleCount = 0;

  function cycle() {
    if (cycleCount < 6) {
      const currentWorkName = workNamesTrio2[cycleCount];

      // Start the work phase
      startCountdown(299, 'audio-rest', currentWorkName, () => {
        // Start the rest phase
        startCountdown(59, 'audio-work', 'Rest', () => {
          cycleCount++;
          cycle(); // Start the next cycle
        });
      });
    } else {
      displayElement.textContent = "Rtimer4"; //Timer end text content
    }
  }

  cycle(); // Start the first cycle
}

// Event listener Rtimer4
Rtimer4.addEventListener('click', () => {
  clearInterval(countdownInterval); // Stop any existing countdown

  // Generate and display the randomized work cycle session
  const workNamesTrio2 = ["A-T", "T-C", "C-A", "A-C", "T-A", "C-T"];
  shuffleArray(workNamesTrio2);// Shuffle once and pass it along
  workCycleList.innerHTML = `<strong>G-A:</strong><br>${workNamesTrio2.join('<br>')}`;

  //Start the "Get Ready" countdown
  startCountdown(15, 'audio-work', 'Get Ready', () => startRtimer4Sequence(workNamesTrio2)); // Initial 10-sec countdown
  });
    
  </script>
</body>
</html>
